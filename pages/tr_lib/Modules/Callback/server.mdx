# Server-Side Callbacks

Callbacks provide server-client communication with synchronous-style syntax.

## register
Register a callback that clients can call. Automatically receives `source` as the first parameter.
```lua
exports.tr_lib:register(name, func)
```

### Parameters
* `name` (string) - Unique identifier for the callback
* `func` (function) - Function to execute when callback is triggered (receives `source` as first parameter)

### Returns
* `success` (boolean) - Always returns `true`
* `message` (string) - Status message

### Example
```lua
exports.tr_lib:register('getVehicle', function(source)
    local vehicle = GetPlayerVehicle(source)
    if not vehicle then return nil end
    
    return {
        plate = vehicle.plate,
        model = vehicle.model
    }
end)
```

## await
Call a client callback and wait for the result.
```lua
exports.tr_lib:await([debug], name, source, [timeout], ...any)
```

### Parameters
* `debug` (boolean, optional) - Enable debug logging for this callback
* `name` (string) - Name of the client callback to trigger
* `source` (number) - Player server ID
* `timeout` (number, optional) - Timeout in milliseconds (default: 10000)
* `...any` - Additional arguments to pass to the callback

### Returns
* `any` Response from the oposite side 

### Examples
```lua
RegisterCommand('impound', function(source)
    local vehicleData = exports.tr_lib:await('getVehicleData', source)
    
    if vehicleData then
        ImpoundVehicle(vehicleData.plate)
    else
        print('Player not in vehicle')
    end
end)
```

## Notes
* Errors are logged to console and return `nil` to the caller.
* Server callbacks automatically receive `source` (player ID) as first parameter
* Default timeout: 10000ms (10 seconds)
* Timeout is specified in milliseconds
* Debug mode logs callback triggers, returns, and timeouts
* Runtime errors are caught and logged automatically
* Automatically handles nil returns and multiple return values
* Backward compatible - both `debug` and `timeout` parameters are optional